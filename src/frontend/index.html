+{% extends "base.html" %}
{% block title %}Index{% endblock %}
{% set active_page = "home" %}
{% block html_head %}
{% endblock %}
{% block content %}

<div class="d-flex justify-content-center flex-nowrap">
    <div class="mx-5 my-5 px-5" style="border-style:solid; border-width: thin; border-color: ghostwhite; border-radius: 25px; padding-top: 20px; position:relative;">
        <form action="{{ url_for('home')}}" method="post">
            <div class="form-group">
                <fieldset>
                    <div class="row">
                        {% for key, value in settings %}
                        <div class="col-md-6">
                            <div class="input-group mb-3">
                                <span class="input-group-text" style="min-width: 150px;">{{maps[key]}}</span>
                                <select class="form-control" name="{{key}}" value="{{value}}" placeholder="{{value}}" id="{{key}}">
                                    {% for agent in agents %}
                                        {% if agent == value %}
                                            <option value="{{agent}}" selected>{{agent}}</option>
                                        {% else %}
                                            <option value="{{agent}}">{{agent}}</option>
                                        {% endif %}
                                    {%endfor%}
                                </select>              
                            </div>
                        </div>
                        {%endfor%}
                    </div>
                </fieldset>
                <button type="submit" class="col align-self-center mt-4 btn btn-primary">Update</button>
            </div>
        </form>
        <div class="custom-control custom-switch" style="position: absolute; bottom: -30px; left: 10px;">
            <input onchange="updateToggle()" type="checkbox" class="custom-control-input" id="customSwitch1" {% if toggle_on %}checked{% endif %}>
            <label class="custom-control-label" for="customSwitch1">Instalock</label>
        </div>
        <p id="currentMap" style="position: absolute; bottom: -47px; left: 436px;">
            {{currentMap}}
        </p>
        <p id="currentTeam" style="position: absolute; bottom: -47px; left: 830px;">
            {{currentTeam}}
        </p>
    </div>
</div>
{% endblock %}
{% block javascript %}
    <script>
        function updateMapTeam() {
            $.get("{{url_for('updateMapTeam')}}", data => {
                if (data != '')
                    $('#currentMap').text(data[0]);
                    $('#currentTeam').text(data[1]);
            })
        }

        function updateToggle() {
            $.get("{{url_for('toggle')}}", () => {});
        }

        setInterval(updateMapTeam, 7500);

    </script>
{% endblock %}